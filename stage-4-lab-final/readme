The finished code from Thu
